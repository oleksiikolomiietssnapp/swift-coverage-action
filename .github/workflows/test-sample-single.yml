name: Test Sample (Single Job)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch: # Allow manual triggering

jobs:
  coverage:
    permissions:
      contents: read
      pull-requests: write
      issues: write
    strategy:
      fail-fast: false
      matrix:
        include:
          - swift: "6.0"
            xcode: "16.0"
            macos: "15"
          - swift: "6.1"
            xcode: "16.3"
            macos: "15"
          - swift: "6.2"
            xcode: "16.0"
            macos: "26"
    uses: ./.github/workflows/swift-coverage.yml
    with:
      macos-version: "${{ matrix.macos }}"
      xcode-version: "${{ matrix.xcode }}"
      project-name-override: "SampleMultiTarget"
      working-directory: "./sample"
      coverage-comment-header: "### ðŸ“Š Sample Coverage Report (Swift ${{ matrix.swift }} - Xcode ${{ matrix.xcode }})"
      post-comment: true  # Posts individual PR comment per matrix job
